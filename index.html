<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MBA lite: Domine a Gestão Estratégica com um programa intensivo e prático. Aprenda sobre Pessoas, Riscos, Qualidade, Projetos, Ferramentas e IA com Danúbio Coelho.">
    <title>MBA lite - Domine a Alta Performance</title>
    <link rel="icon" type="image/png" href="https://placehold.co/32x32/2563eb/FFFFFF?text=MBA">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://mbalite.kit.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --header-height: 70px;
            --scroll-offset: calc(var(--header-height) + 20px);
            --color-primary: theme('colors.blue.600');
            --color-primary-dark: theme('colors.blue.700');
            --color-text-on-primary: theme('colors.white');
            --color-text-title: theme('colors.gray.900');
            --color-text-body: theme('colors.gray.700');
            --color-text-muted: theme('colors.gray.500');
            --color-bg-main: theme('colors.gray.50');
            --color-bg-surface: theme('colors.white');
            --color-bg-surface-dark: theme('colors.gray.100');
            --color-border: theme('colors.gray.200');
            --color-border-dark: theme('colors.gray.300');
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Open Sans', sans-serif; background-color: var(--color-bg-main); color: var(--color-text-body);
            padding-top: var(--header-height); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
            display: flex; flex-direction: column; min-height: 100vh; font-synthesis: none;
        }
        main { flex-grow: 1; }
        .scroll-target { scroll-margin-top: var(--scroll-offset); }

        h2.section-title { color: var(--color-text-title); position: relative; padding-bottom: 15px; }
        h2.section-title::after { content: ''; display: block; width: 50px; height: 3px; background-color: var(--color-primary); position: absolute; left: 50%; transform: translateX(-50%); bottom: 0; }
        h2.section-title.text-left::after { left: 0; transform: none; }

        .icon-block-card { border: 1px solid var(--color-border); transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .icon-block-card:hover { transform: translateY(-5px); }
        .icon-block-card .icon { color: var(--color-primary); transition: transform 0.3s ease; }
        .icon-block-card:hover .icon { transform: scale(1.1); }

        .page-content-container article { background-color: var(--color-bg-surface); border: 1px solid var(--color-border); }
        .page-content-container article h2 { color: var(--color-primary); border-bottom: 1px solid var(--color-border); }

        .faq-item { background-color: var(--color-bg-surface); border: 1px solid var(--color-border); transition: box-shadow 0.2s ease; }
        .faq-item:hover { box-shadow: theme('boxShadow.md'); }
        .faq-item summary { position: relative; list-style: none; cursor: pointer; }
        .faq-item summary::after { content: '+'; position: absolute; right: 20px; top: 50%; transform: translateY(-50%); font-size: 1.5rem; font-weight: 300; color: var(--color-primary); transition: transform 0.2s ease; }
        .faq-item[open] > summary::after { content: '−'; transform: translateY(-50%) rotate(180deg); }
        .faq-item summary::-webkit-details-marker { display: none; }
        .faq-item .faq-content { border-top: 1px solid var(--color-border); }

        #main-header {
            background-color: var(--color-bg-surface); /* White background */
            box-shadow: theme('boxShadow.sm'); height: var(--header-height); transition: box-shadow 0.3s ease;
            position: fixed; top: 0; left: 0; width: 100%; z-index: 50; /* Above content */
        }
        #main-header.header-scrolled { box-shadow: theme('boxShadow.md'); }
        #main-nav a.nav-link { position: relative; padding-bottom: 5px; transition: color 0.3s ease; color: var(--color-text-body); font-weight: 600; }
        #main-nav a.nav-link::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px; background-color: var(--color-primary); transform: scaleX(0); transform-origin: bottom right; transition: transform 0.3s ease-out; }
        #main-nav a.nav-link:hover, #main-nav a.nav-link.active { color: var(--color-primary); }
        #main-nav a.nav-link:hover::after, #main-nav a.nav-link.active::after { transform: scaleX(1); transform-origin: bottom left; }

        #mobile-menu {
            /* background-color: var(--color-bg-surface); /* Let Tailwind handle it via class */
            transition: transform 0.3s ease-in-out; border-right: 1px solid var(--color-border);
            position: fixed; top: 0; left: 0; width: 16rem; height: 100%; z-index: 60; /* Above header */
        }
        #mobile-menu.hidden-menu { transform: translateX(-100%); }
        #mobile-menu nav a.mobile-menu-link { transition: color 0.2s ease, background-color 0.2s ease; color: var(--color-text-body); }
        #mobile-menu nav a.mobile-menu-link:hover, #mobile-menu nav a.mobile-menu-link.active { color: var(--color-primary); background-color: theme('colors.blue.50'); }
        #menu-overlay { background-color: rgba(0, 0, 0, 0.5); transition: opacity 0.3s ease-in-out; position: fixed; inset: 0; z-index: 55; /* Between header and menu */ }
        #menu-overlay.hidden { opacity: 0; pointer-events: none; }

        #scroll-to-top { position: fixed; bottom: 30px; right: 30px; background-color: var(--color-primary); color: var(--color-text-on-primary); width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease, background-color 0.3s ease; box-shadow: theme('boxShadow.lg'); z-index: 1000; border: none; }
        #scroll-to-top.visible { opacity: 1; visibility: visible; }
        #scroll-to-top:hover { background-color: var(--color-primary-dark); transform: translateY(-3px); }

        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--color-bg-main); display: flex; justify-content: center; align-items: center; z-index: 9999; opacity: 1; transition: opacity 0.5s ease 0.3s; }
        #preloader.hidden { opacity: 0; pointer-events: none; }
        .spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: var(--color-primary); animation: spin 1s ease infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .page { display: none; animation: pageFadeIn 0.5s ease-out forwards; }
        .page.active { display: block; }
        @keyframes pageFadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Minimal ConvertKit Overrides */
        #enroll .form-wrapper { background-color: var(--color-bg-surface); }
        #enroll form.seva-form.formkit-form { border: none !important; background-color: transparent !important; padding: 0 !important; margin: 0 auto !important; border-radius: 0 !important; box-shadow: none !important; max-width: 550px !important; }
        #enroll .ck-form-container { max-width: 100% !important; width: 100%; margin: 0 !important; padding: 0 !important; background: none !important; border: none !important; box-shadow: none !important; text-align: left !important; }
        #enroll .ck-form-container .ck-header, #enroll .ck-form-container .ck-content { display: none !important; }
        #enroll .ck-form-container .ck-fields { background: none !important; padding: 0 !important; }
        #enroll .ck-form-container .ck-field label { color: var(--color-text-body) !important; }
        #enroll .ck-form-container .ck-input, #enroll form.formkit-form .formkit-field .formkit-input { border: 1px solid var(--color-border-dark) !important; background-color: var(--color-bg-surface) !important; color: var(--color-text-title) !important; transition: box-shadow 0.2s ease, border-color 0.2s ease !important; }
        #enroll .ck-form-container .ck-input::placeholder, #enroll form.formkit-form .formkit-field .formkit-input::placeholder { color: var(--color-text-muted) !important; opacity: 1; }
        #enroll .ck-form-container .ck-input:focus, #enroll form.formkit-form .formkit-field .formkit-input:focus { outline: none !important; border-color: var(--color-primary) !important; box-shadow: 0 0 0 3px theme('colors.blue.200') !important; }
        #enroll .ck-form-container .ck-button { background-color: var(--color-primary) !important; border-color: var(--color-primary) !important; color: var(--color-text-on-primary) !important; transition: all 0.3s ease !important; }
        #enroll .ck-form-container .ck-button:hover { background-color: var(--color-primary-dark) !important; border-color: var(--color-primary-dark) !important; transform: translateY(-2px); box-shadow: theme('boxShadow.lg') !important; }
        #enroll .ck-form-container .ck-powered-by, #enroll .ck-form-container .ck-powered-by a { color: var(--color-text-muted) !important; }
        #enroll .ck-form-container .ck-powered-by a:hover { color: var(--color-primary) !important; }

        .notion-style-svg { max-width: 100px; height: auto; opacity: 0.7; margin-bottom: 1rem; margin-left: auto; margin-right: auto; display: block; }
        .experience-item .timeline-line { border-left-color: var(--color-border-dark); }
    </style>

    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Course","name":"MBA lite","description":"Domine a Gestão Estratégica com o MBA lite - Um programa intensivo e prático, focado nas competências essenciais para liderar equipes, gerenciar projetos complexos e impulsionar resultados sustentáveis.","provider":{"@type":"Person","name":"Danúbio Coelho","url":"/autor","sameAs":"https://www.linkedin.com/in/danubiocoelho/"},"courseCode":"MBALITE","educationalCredentialAwarded":"Certificate of Completion","hasCourseInstance":{"@type":"CourseInstance","courseMode":"Online","instructor":{"@type":"Person","name":"Danúbio Coelho"}},"url":"/"}</script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Book","name":"Gestão de Pessoas para Alta Performance: Desvendando o Potencial Humano para Resultados Extraordinários","author":{"@type":"Person","name":"Danúbio Coelho"},"url":"/publicacoes","workExample":[{"@type":"Book","isbn":"YOUR_ISBN_HERE","bookEdition":"1st Edition","bookFormat":"https://schema.org/EBook","potentialAction":{"@type":"ReadAction","target":{"@type":"EntryPoint","urlTemplate":"AMAZON_LINK_HERE","actionPlatform":["https://schema.org/DesktopWebPlatform","https://schema.org/IOSPlatform","https://schema.org/AndroidPlatform"]}}}]}</script>

</head>
<body class="bg-bg-main text-text-body">

    <div id="preloader"><div class="spinner"></div></div>

    <header id="main-header">
        <div class="container mx-auto px-4 md:px-6 lg:px-8 h-full flex justify-between items-center">
            <a href="/" data-page-id="page-index" data-scroll-target="hero" class="text-2xl font-bold text-gray-900 hover:text-blue-600 transition duration-300">MBA lite</a>
            <nav id="main-nav" class="hidden lg:flex space-x-7 items-center">
                <a href="/" data-page-id="page-index" data-scroll-target="hero" class="nav-link">Início</a>
                <a href="/#modules" data-page-id="page-index" data-scroll-target="modules" class="nav-link">Módulos</a>
                <a href="/publicacoes" data-page-id="page-publications" class="nav-link">Publicações</a>
                <a href="/autor" data-page-id="page-autor" class="nav-link">Autor</a>
                <a href="/faq" data-page-id="page-faq" class="nav-link">FAQ</a>
                <a href="/#enroll" data-page-id="page-index" data-scroll-target="enroll" class="ml-4 inline-block px-6 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-md hover:bg-blue-700 hover:shadow-lg hover:-translate-y-0.5 transform transition duration-300 ease-in-out">Inscreva-se</a>
            </nav>
            <button id="menu-btn" class="lg:hidden focus:outline-none text-gray-700 hover:text-blue-600" aria-label="Abrir menu" aria-expanded="false" aria-controls="mobile-menu"><i class="fas fa-bars text-xl" aria-hidden="true"></i></button>
        </div>
    </header>

    <div id="mobile-menu" class="hidden-menu bg-white shadow-lg" role="dialog" aria-modal="true" aria-labelledby="mobile-menu-title">
         <div class="flex justify-between items-center mb-8 px-6 pt-6">
           <span id="mobile-menu-title" class="text-xl font-semibold text-gray-800">Menu</span>
           <button id="close-menu-btn" class="text-gray-500 hover:text-blue-600 focus:outline-none" aria-label="Fechar menu"><i class="fas fa-times text-xl" aria-hidden="true"></i></button>
         </div>
         <nav class="flex flex-col space-y-1 px-3" aria-label="Navegação móvel">
           <a href="/" data-page-id="page-index" data-scroll-target="hero" class="block font-medium py-2.5 px-3 rounded-md mobile-menu-link">Início</a>
           <a href="/#modules" data-page-id="page-index" data-scroll-target="modules" class="block font-medium py-2.5 px-3 rounded-md mobile-menu-link">Módulos</a>
           <a href="/publicacoes" data-page-id="page-publications" class="block font-medium py-2.5 px-3 rounded-md mobile-menu-link">Publicações</a>
           <a href="/autor" data-page-id="page-autor" class="block font-medium py-2.5 px-3 rounded-md mobile-menu-link">Autor</a>
           <a href="/faq" data-page-id="page-faq" class="block font-medium py-2.5 px-3 rounded-md mobile-menu-link">FAQ</a>
           <a href="/#enroll" data-page-id="page-index" data-scroll-target="enroll" class="block text-center font-semibold mt-4 mx-3 py-2.5 px-6 rounded-md mobile-menu-link bg-blue-600 text-white uppercase tracking-wider border-2 border-blue-600 hover:bg-blue-700 hover:border-blue-700 transition-all duration-300 ease-in-out">Inscreva-se</a>
         </nav>
    </div>
    <div id="menu-overlay" class="hidden" aria-hidden="true"></div>

    <main id="main-content">
        <div id="page-index" class="page">...</div>
        <div id="page-content" class="page">...</div>
        <div id="page-autor" class="page">...</div>
        <div id="page-faq" class="page">...</div>
        <div id="page-publications" class="page">...</div>
    </main>

    <footer class="bg-bg-surface py-10 border-t border-border-color mt-16 px-5">
        <div class="container mx-auto text-center text-text-muted">
            <div class="footer-social-icons flex justify-center space-x-6 mb-6">
                <a href="mailto:dan@mbalite.com.br" title="Email" aria-label="Enviar email para Danúbio Coelho" class="text-gray-500 hover:text-blue-600 transition duration-300 text-2xl"><i class="fas fa-envelope" aria-hidden="true"></i></a>
                <a href="https://www.linkedin.com/in/danubiocoelho/" target="_blank" rel="noopener noreferrer" title="LinkedIn" aria-label="Ver perfil de Danúbio Coelho no LinkedIn" class="text-gray-500 hover:text-blue-600 transition duration-300 text-2xl"><i class="fab fa-linkedin" aria-hidden="true"></i></a>
            </div>
            <p class="text-sm">&copy; <span id="current-year"></span> MBA lite Program. Todos os direitos reservados.</p>
            <p class="text-xs mt-1">Uma iniciativa de Danúbio Coelho para capacitar os líderes do futuro.</p>
            <p class="text-xs mt-2">Brasília - DF, Brasil</p>
        </div>
    </footer>

    <button id="scroll-to-top" title="Voltar ao topo" aria-label="Voltar ao topo"><i class="fas fa-arrow-up" aria-hidden="true"></i></button>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Simplified JS
        document.addEventListener('DOMContentLoaded', () => {
            const SCROLL_TOP_VISIBILITY_THRESHOLD = 300; const HEADER_SCROLL_THRESHOLD = 50; const PAGE_FADE_DURATION = 500; const PRELOADER_FADE_DELAY = 300;
            const elements = { preloader: document.getElementById('preloader'), header: document.getElementById('main-header'), scrollToTopBtn: document.getElementById('scroll-to-top'), menuBtn: document.getElementById('menu-btn'), closeMenuBtn: document.getElementById('close-menu-btn'), mobileMenu: document.getElementById('mobile-menu'), menuOverlay: document.getElementById('menu-overlay'), currentYearSpan: document.getElementById('current-year'), mainNavLinks: document.querySelectorAll('#main-nav a.nav-link'), mobileMenuLinks: document.querySelectorAll('#mobile-menu a.mobile-menu-link'), allPages: document.querySelectorAll('.page'), allSpaLinks: document.querySelectorAll('a[data-page-id], a[data-internal-target], a[href^="/"], a[href^="#"]') };
            const pageRoutes = { '/': { id: 'page-index', title: 'MBA lite - Início' }, '/publicacoes': { id: 'page-publications', title: 'MBA lite - Publicações' }, '/autor': { id: 'page-autor', title: 'MBA lite - Sobre o Autor' }, '/faq': { id: 'page-faq', title: 'MBA lite - FAQ' }, '/content': { id: 'page-content', title: 'MBA lite - Detalhes do Módulo'} };
            const defaultPageRoute = pageRoutes['/']; const contentPageId = 'page-content';
            let isMenuOpen = false, headerHeight = 70, scrollOffset = 90;

            function updateDynamicOffsets() { try { const rootStyles = getComputedStyle(document.documentElement); const headerHeightValue = rootStyles.getPropertyValue('--header-height').trim(); const scrollOffsetValue = rootStyles.getPropertyValue('--scroll-offset').trim(); if (headerHeightValue) headerHeight = parseInt(headerHeightValue, 10) || 70; if (scrollOffsetValue) { const match = scrollOffsetValue.match(/calc\(\s*var\(--header-height\)\s*\+\s*(\d+)px\s*\)/); scrollOffset = (match && match[1]) ? headerHeight + (parseInt(match[1], 10) || 20) : (parseInt(scrollOffsetValue, 10) || headerHeight + 20); } } catch (e) { scrollOffset = headerHeight + 20; } }
            function initPreloader() { window.addEventListener('load', () => { updateDynamicOffsets(); if (elements.preloader) { elements.preloader.classList.add('hidden'); setTimeout(() => { elements.preloader?.remove(); }, PAGE_FADE_DURATION + PRELOADER_FADE_DELAY); } initAOS(); handleRouteChange(true); }); }
            function initAOS() { if (typeof AOS !== 'undefined') AOS.init({ duration: 600, once: true, offset: 50, easing: 'ease-out-quad' }); else console.warn("AOS library not loaded."); }
            function initMobileMenu() { if (!elements.menuBtn || !elements.closeMenuBtn || !elements.mobileMenu || !elements.menuOverlay) return; elements.menuBtn.addEventListener('click', toggleMenu); elements.closeMenuBtn.addEventListener('click', closeMenu); elements.menuOverlay.addEventListener('click', closeMenu); elements.mobileMenuLinks.forEach(link => link.addEventListener('click', closeMenu)); }
            function initScrollEffects() { window.addEventListener('scroll', handleScroll, { passive: true }); elements.scrollToTopBtn?.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' })); }
            function initFooterYear() { if (elements.currentYearSpan) elements.currentYearSpan.textContent = new Date().getFullYear(); }
            function initSPARouting() { elements.allSpaLinks.forEach(link => { const href = link.getAttribute('href'); if (link.getAttribute('target') === '_blank' || link.protocol !== window.location.protocol || link.host !== window.location.host || link.hasAttribute('download') || href?.startsWith('mailto:')) return; link.addEventListener('click', (e) => handleNavLinkClick(e, link)); }); window.addEventListener('popstate', handleRouteChange); }
            function toggleMenu() { isMenuOpen ? closeMenu() : openMenu(); }
            function openMenu() { if (isMenuOpen || !elements.mobileMenu || !elements.menuOverlay || !elements.menuBtn) return; elements.mobileMenu.classList.remove('hidden-menu'); elements.menuOverlay.classList.remove('hidden'); elements.menuBtn.setAttribute('aria-expanded', 'true'); document.body.style.overflow = 'hidden'; isMenuOpen = true; elements.closeMenuBtn?.focus(); }
            function closeMenu() { if (!isMenuOpen || !elements.mobileMenu || !elements.menuOverlay || !elements.menuBtn) return; elements.mobileMenu.classList.add('hidden-menu'); elements.menuOverlay.classList.add('hidden'); elements.menuBtn.setAttribute('aria-expanded', 'false'); document.body.style.overflow = ''; isMenuOpen = false; elements.menuBtn?.focus(); }
            function handleScroll() { const scrollY = window.scrollY; elements.header?.classList.toggle('header-scrolled', scrollY > HEADER_SCROLL_THRESHOLD); elements.scrollToTopBtn?.classList.toggle('visible', scrollY > SCROLL_TOP_VISIBILITY_THRESHOLD); updateActiveNavLink(); }
            function displayPage(targetPageId) { let targetPageElement = null; elements.allPages.forEach(page => { const isTarget = page.id === targetPageId; page.style.display = isTarget ? 'block' : 'none'; page.classList.remove('active'); if (isTarget) targetPageElement = page; }); if (!targetPageElement) { targetPageId = defaultPageRoute.id; targetPageElement = document.getElementById(targetPageId); if (targetPageElement) { targetPageElement.style.display = 'block'; targetPageElement.classList.remove('active'); } else { console.error("Default page element not found!"); return null; } } document.body.className = `bg-bg-main text-text-body page-${targetPageId}`; return targetPageElement; }
            function updateTitle(pageId, scrollTargetId) { let routeInfo = Object.values(pageRoutes).find(route => route.id === pageId) || defaultPageRoute; let pageTitle = routeInfo.title; if (pageId === contentPageId && scrollTargetId) { const sectionElement = document.getElementById(scrollTargetId); const sectionTitleElement = sectionElement?.querySelector('h2'); if (sectionTitleElement) { const titleClone = sectionTitleElement.cloneNode(true); if (titleClone.firstChild?.nodeName === 'I') titleClone.removeChild(titleClone.firstChild); const sectionTitleText = titleClone.textContent?.trim(); if (sectionTitleText) pageTitle = `MBA lite - ${sectionTitleText}`; } } document.title = pageTitle; }
            function handleScrollingAndActivation(scrollTargetId, isInitialLoad, pageElementToActivate) { const activatePage = () => { if (pageElementToActivate) setTimeout(() => pageElementToActivate.classList.add('active'), isInitialLoad ? 10 : 50); if (typeof AOS !== 'undefined' && !isInitialLoad && pageElementToActivate) setTimeout(() => AOS.refreshHard(), PAGE_FADE_DURATION + 50); setTimeout(updateActiveNavLink, 150); }; if (scrollTargetId) { const scrollElement = document.getElementById(scrollTargetId); if (scrollElement) { const elementPosition = scrollElement.getBoundingClientRect().top + window.scrollY; window.scrollTo({ top: elementPosition - scrollOffset, behavior: isInitialLoad ? 'auto' : 'smooth' }); activatePage(); } else { window.scrollTo({ top: 0, behavior: isInitialLoad ? 'auto' : 'smooth' }); activatePage(); } } else { if (!isInitialLoad && window.scrollY > 0) window.scrollTo({ top: 0, behavior: 'smooth' }); activatePage(); } }
            function handleNavLinkClick(event, link) { const href = link.getAttribute('href'); if (!href) return; const targetPageId = link.dataset.pageId; const internalTargetPageId = link.dataset.internalTarget; const scrollTargetId = link.dataset.scrollTarget || (href.startsWith('#') ? href.substring(1) : null); if (internalTargetPageId && scrollTargetId) { event.preventDefault(); const newHref = window.location.pathname + `#${scrollTargetId}`; history.pushState({ pageId: internalTargetPageId, scrollTarget: scrollTargetId }, '', newHref); handleRouteChange(); return; } if (targetPageId && (href.startsWith('/') || href.startsWith('#'))) { event.preventDefault(); const newPath = href.split('#')[0] || '/'; const newHash = href.includes('#') ? href.split('#')[1] : null; const finalScrollTarget = scrollTargetId || newHash; history.pushState({ pageId: targetPageId, scrollTarget: finalScrollTarget }, '', href); handleRouteChange(); return; } if (href.startsWith('#') && !targetPageId && !internalTargetPageId) { const targetId = href.substring(1); const targetElement = document.getElementById(targetId); const activePage = document.querySelector('.page.active'); if (targetElement && activePage?.contains(targetElement)) { event.preventDefault(); const elementPosition = targetElement.getBoundingClientRect().top + window.scrollY; window.scrollTo({ top: elementPosition - scrollOffset, behavior: 'smooth' }); history.replaceState(history.state, '', window.location.pathname + href); setTimeout(updateActiveNavLink, 150); } return; } }
            function handleRouteChange(isInitialLoad = false) { const path = window.location.pathname; const hash = window.location.hash.substring(1); let targetPageId, scrollTargetId = hash || null, routeInfo; if (history.state?.pageId) { targetPageId = history.state.pageId; scrollTargetId = history.state.scrollTarget || scrollTargetId; routeInfo = Object.values(pageRoutes).find(r => r.id === targetPageId); } else if (pageRoutes[path]) { routeInfo = pageRoutes[path]; targetPageId = routeInfo.id; } else { routeInfo = defaultPageRoute; targetPageId = routeInfo.id; } routeInfo = routeInfo || defaultPageRoute; if (targetPageId === contentPageId && !scrollTargetId) scrollTargetId = 'content-area'; const pageElement = displayPage(targetPageId); updateTitle(targetPageId, scrollTargetId); handleScrollingAndActivation(scrollTargetId, isInitialLoad === true, pageElement); }
            function updateActiveNavLink() { const scrollY = window.scrollY; const activePageElement = document.querySelector('.page.active'); if (!activePageElement) return; let currentSectionId = null, bestMatch = { id: null, top: -Infinity }; activePageElement.querySelectorAll('.scroll-target').forEach(section => { const sectionTop = section.getBoundingClientRect().top + window.scrollY; if (sectionTop <= scrollY + scrollOffset + 50 && sectionTop > bestMatch.top) bestMatch = { id: section.id, top: sectionTop }; }); currentSectionId = bestMatch.id; const updateLinks = (links) => { let isAnySectionLinkActive = false; links.forEach(link => { link.classList.remove('active'); const linkHref = link.getAttribute('href'); if (!linkHref) return; const linkPageId = link.dataset.pageId; const linkInternalTargetPageId = link.dataset.internalTarget; const linkScrollTarget = link.dataset.scrollTarget; const linkHash = linkHref.includes('#') ? linkHref.split('#')[1] : null; const isLinkForActivePage = (linkPageId === activePageElement.id) || (linkInternalTargetPageId === activePageElement.id); if (!isLinkForActivePage) return; if (currentSectionId && (linkScrollTarget === currentSectionId || linkHash === currentSectionId)) { link.classList.add('active'); isAnySectionLinkActive = true; } }); if (!isAnySectionLinkActive) { links.forEach(link => { const linkHref = link.getAttribute('href'); if (!linkHref) return; const linkPageId = link.dataset.pageId; const linkInternalTargetPageId = link.dataset.internalTarget; const linkScrollTarget = link.dataset.scrollTarget; const linkHash = linkHref.includes('#') ? linkHref.split('#')[1] : null; const isLinkForActivePage = (linkPageId === activePageElement.id) || (linkInternalTargetPageId === activePageElement.id); if (isLinkForActivePage && !linkScrollTarget && !linkHash) link.classList.add('active'); }); } }; updateLinks(elements.mainNavLinks); updateLinks(elements.mobileMenuLinks); updateLinks(document.querySelectorAll('.module-link')); }
            initPreloader(); initMobileMenu(); initScrollEffects(); initFooterYear(); initSPARouting();
            // Server Config Note: For SPA routing to work on refresh/direct access, web server must serve index.html for all routes.
        });
    </script>

</body>
</html>